# Chromium GN Pool 함수 가이드

`pool` 함수는 빌드 과정에서 특정 작업들의 **동시 실행 수(Concurrency)**를 제한하기 위해 사용되는 명명된 객체를 정의합니다. 메모리를 많이 사용하는 작업(예: 링크)이나 시스템 리소스를 독점해야 하는 작업들이 동시에 너무 많이 실행되어 시스템이 멈추는 것을 방지할 때 유용합니다.

## 1. 기본 문법 (Basic Syntax)

```gn
pool("pool_name") {
  depth = 1
}
```

*   **`pool_name`**: 풀의 이름입니다.
*   **`depth`**: (필수) 이 풀을 사용하는 작업들이 동시에 실행될 수 있는 최대 개수입니다.

## 2. 사용 방법 (Usage)

풀을 정의한 후, `action` 타겟이나 `toolchain` 정의 내부에서 `pool` 변수에 풀의 라벨을 지정하여 사용합니다.

### 2.1. Action 타겟에서 사용

특정 스크립트 실행이 메모리를 많이 차지하는 경우, 해당 `action`들이 동시에 실행되는 것을 제한할 수 있습니다.

```gn
# 1. 풀 정의 (동시 실행 1개로 제한)
pool("heavy_task_pool") {
  depth = 1
}

# 2. 풀 사용
action("memory_intensive_task") {
  script = "process_huge_data.py"
  pool = ":heavy_task_pool"
  # ...
}
```

### 2.2. Toolchain에서 사용

특정 컴파일러나 링커 도구의 동시 실행 수를 제한할 때 사용합니다. 예를 들어, 링크 작업(LTO 등)은 메모리를 매우 많이 사용하므로 동시 실행 수를 줄이는 것이 일반적입니다.

```gn
# //build/toolchain/BUILD.gn

pool("link_pool") {
  depth = 4
}

toolchain("gcc") {
  tool("link") {
    command = "..."
    pool = ":link_pool"
  }
  # ...
}
```

## 3. 내장 풀 (Built-in Pools)

GN은 기본적으로 `console`이라는 특수 풀을 제공합니다.

*   **`console`**: `depth = 1`인 풀입니다. 이 풀을 사용하는 작업은 Ninja의 콘솔 출력 버퍼링을 우회하여 표준 출력(stdout)을 터미널에 직접 출력합니다. 사용자와 상호작용이 필요하거나 로그를 실시간으로 봐야 하는 작업에 유용합니다.

```gn
action("interactive_script") {
  script = "ask_user.py"
  pool = "console"
}
```

## 4. 주의사항

*   **전역 제한 아님**: `pool`은 해당 풀을 명시적으로 사용하는 타겟들 사이에서만 제한을 겁니다. 풀을 사용하지 않는 다른 타겟들은 여전히 Ninja의 기본 병렬 처리 설정(`-j`)에 따라 실행됩니다.
*   **Ninja 파일**: GN의 `pool` 정의는 Ninja 빌드 파일의 `pool` 선언으로 변환됩니다.
