# Chromium GN not_needed 함수 가이드

`not_needed` 함수는 특정 스코프(주로 템플릿의 `invoker`) 내의 변수들이 사용되지 않았다는 오류가 발생하는 것을 방지하기 위해 사용됩니다. "이 변수들의 존재를 인지하고 있으며, 의도적으로 사용하지 않았으니 오류를 발생시키지 말라"고 GN에 명시적으로 알려주는 역할을 합니다.

## 1. 기본 문법 (Basic Syntax)

```gn
not_needed(source_scope, list_of_variable_names)
```

*   **`source_scope`**: 변수를 읽어올 스코프 객체입니다. 템플릿 내에서는 거의 항상 `invoker`가 됩니다.
*   **`list_of_variable_names`**: 사용되지 않음을 명시할 변수 이름들의 문자열 리스트입니다. 와일드카드(`*`)를 사용할 수도 있습니다.

## 2. 작동 원리 (How it works)

GN은 `BUILD.gn` 파일의 무결성을 유지하기 위해, 정의되었지만 어떤 타겟의 속성으로도 할당되지 않은 변수가 있으면 "unused variable" 오류를 발생시킵니다.

`not_needed` 함수는 지정된 변수들을 "사용된 것"으로 간주하도록 GN에 알려주어 이 오류를 방지합니다.

## 3. 사용 예시 (Usage Examples)

### 템플릿의 선택적 인자 처리

템플릿이 호출자로부터 여러 변수를 받지만, 그중 일부는 템플릿 내부 로직에서만 사용되고 실제 타겟으로 전달되지 않을 때 주로 사용됩니다.

```gn
template("my_wrapper") {
  # 'use_extra_defines'는 템플릿 내부 로직에서만 사용됨
  if (defined(invoker.use_extra_defines) && invoker.use_extra_defines) {
    _extra_defines = [ "ENABLE_EXTRA_FEATURE" ]
  } else {
    _extra_defines = []
  }

  # 'use_extra_defines' 변수가 사용되지 않았다는 오류를 방지
  not_needed(invoker, [ "use_extra_defines" ])

  executable(target_name) {
    # 'use_extra_defines'를 제외한 나머지 변수들을 전달
    forward_variables_from(invoker, "*", [ "use_extra_defines" ])

    # 템플릿 로직에 따라 계산된 defines를 추가
    defines += _extra_defines
  }
}

# 사용
my_wrapper("app") {
  sources = [ "main.cc" ]
  use_extra_defines = true  # 이 변수는 not_needed로 처리됨
}
```

위 예제에서 `not_needed`가 없다면, `use_extra_defines` 변수가 `executable` 타겟의 어떤 속성으로도 직접 할당되지 않았기 때문에 GN은 "unused variable" 오류를 발생시킵니다.

## 4. `forward_variables_from`과의 관계

`not_needed`는 `forward_variables_from`과 함께 사용될 때 그 역할이 명확해집니다.

*   `forward_variables_from(invoker, "*", ["var"])`: `var`를 제외하고 모든 변수를 전달하는 것이 `not_needed`를 사용하는 것보다 더 명확하고 좋은 방법일 수 있습니다.
*   `forward_variables_from(invoker, ["sources", "deps"])`: 특정 변수만 명시적으로 전달할 때, `invoker`에 정의된 다른 변수들(예: `visibility`)에 대해 "unused" 오류가 발생할 수 있습니다. 이때 `not_needed(invoker, ["visibility"])`를 사용하여 오류를 막을 수 있습니다.
