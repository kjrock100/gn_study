# Chromium GN set_default_toolchain 함수 가이드

`set_default_toolchain` 함수는 빌드에 사용할 **기본 툴체인(Default Toolchain)**을 지정하는 필수 함수입니다. 이 함수는 `BUILDCONFIG.gn` 파일 내에서 단 한 번만 호출되어야 하며, 전체 빌드 구성의 시작점 역할을 합니다.

## 1. 역할 (Role)

*   **기본 빌드 환경 설정**: `gn gen`이 실행될 때, GN은 이 함수에 지정된 툴체인을 사용하여 타겟(Target)들을 처리하기 시작합니다.
*   **타겟 아키텍처 결정**: 기본 툴체인은 주로 `target_os`와 `target_cpu` 같은 빌드 인자에 따라 동적으로 선택되며, 이는 최종 산출물이 실행될 환경을 결정합니다.

## 2. 기본 문법 (Basic Syntax)

```gn
set_default_toolchain(toolchain_label)
```

*   **`toolchain_label`**: 사용할 툴체인을 가리키는 라벨(Label) 문자열입니다. 이 라벨은 `toolchain` 타겟을 가리켜야 합니다.

## 3. 사용 예시 (Usage in `BUILDCONFIG.gn`)

`set_default_toolchain`은 거의 항상 `BUILDCONFIG.gn` 파일 내에서 플랫폼(OS)과 아키텍처(CPU)에 따라 분기 처리와 함께 사용됩니다.

```gn
# //build/config/BUILDCONFIG.gn

# ... (is_debug, target_os, target_cpu 등 빌드 인자 선언 및 설정) ...

# 플랫폼에 맞는 기본 툴체인 라벨을 설정
if (current_os == "linux") {
  set_default_toolchain("//build/toolchain/linux:clang_$target_cpu")
} else if (current_os == "win") {
  set_default_toolchain("//build/toolchain/win:clang_$target_cpu")
} else if (current_os == "mac") {
  set_default_toolchain("//build/toolchain/mac:clang_$target_cpu")
}

# ...
```

위 예제에서 `target_cpu`가 `"x64"`이고 `current_os`가 `"linux"`라면, GN은 `//build/toolchain/linux:clang_x64` 라벨이 가리키는 `toolchain` 타겟을 기본 툴체인으로 로드합니다.

## 4. 툴체인 전환 (Toolchain Switching)

`set_default_toolchain`으로 설정된 툴체인은 "기본값"일 뿐입니다. 빌드 과정에서 다른 툴체인이 필요할 경우(예: 크로스 컴파일 시 호스트용 도구 빌드), 타겟 라벨에 툴체인을 명시하여 전환할 수 있습니다.

```gn
action("my_action") {
  # my_generator는 기본 툴체인이 아닌 host_toolchain으로 빌드
  deps = [ "//tools:my_generator($host_toolchain)" ]
  # ...
}
```

## 5. 주의사항

*   **필수 호출**: `BUILDCONFIG.gn` 파일은 반드시 `set_default_toolchain`을 한 번 호출해야 합니다. 호출하지 않거나 여러 번 호출하면 오류가 발생합니다.
*   **실행 순서**: 이 함수는 `BUILDCONFIG.gn` 파일의 로직이 거의 끝나는 지점에서 호출되는 것이 일반적입니다. 툴체인 선택에 필요한 모든 변수(`target_os`, `target_cpu` 등)가 결정된 후에 호출되어야 합니다.
