# Chromium GN Tool 함수 가이드

`tool` 함수는 `toolchain` 정의 내에서만 사용되며, 빌드 과정의 각 단계(컴파일, 링크 등)를 수행하는 구체적인 명령어와 규칙을 정의합니다.

## 1. 역할 (Role)

`toolchain`은 컴파일러, 링커 등 도구들의 집합이며, `tool`은 그 집합에 속한 개별 도구 하나하나의 동작을 상세하게 기술하는 역할을 합니다. 예를 들어, "C++ 컴파일러(`cxx`)"는 어떤 명령어를 사용하고, 어떤 출력 파일을 생성하며, 콘솔에 어떤 메시지를 표시할지 등을 `tool("cxx")` 블록 내에 정의합니다.

## 2. 기본 문법 (Basic Syntax)

```gn
toolchain("my_toolchain") {
  tool(<tool_name>) {
    # 도구의 동작을 정의하는 변수들
    command = "..."
    outputs = [ ... ]
    ...
  }
  ...
}
```

*   **`<tool_name>`**: 도구의 역할을 나타내는 문자열입니다. (예: `"cc"`, `"cxx"`, `"link"`)

## 3. 주요 도구 이름 (Key Tool Names)

GN은 특정 역할을 수행하는 도구에 대해 미리 정의된 이름을 사용합니다.

*   `"cc"`: C 컴파일러.
*   `"cxx"`: C++ 컴파일러.
*   `"asm"`: 어셈블러.
*   `"alink"`: 정적 라이브러리 아카이버 (Archiver).
*   `"solink"`: 동적(공유) 라이브러리 링커.
*   `"link"`: 실행 파일 링커.
*   `"stamp"`: 타겟의 빌드가 완료되었음을 표시하는 빈 파일(스탬프 파일)을 생성하는 도구. **(필수)**
*   `"copy"`: 파일을 복사하는 도구. **(필수)**

## 4. `tool` 블록의 주요 변수 (Key Variables)

### `command` (필수)
실제로 실행될 쉘 명령어입니다. GN은 이 문자열에 **치환 패턴(Substitution Patterns)**을 사용하여 소스 파일, 출력 파일, 플래그 등을 채워 넣습니다.
*   예: `command = "gcc -c {{source}} -o {{output}} {{cflags}}"`

### `outputs` (필수)
`command`가 실행된 후 생성되는 파일의 경로를 지정하는 패턴입니다. 이 변수는 빌드 그래프를 구성하는 데 매우 중요합니다.
*   예: `outputs = [ "{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o" ]`

### `description`
빌드 시 콘솔에 출력될 메시지입니다.
*   예: `description = "CXX {{output}}"`

### `depfile`
컴파일러가 생성하는 의존성 파일(`.d` 파일)의 경로를 지정합니다. Ninja는 이 파일을 사용하여 헤더 파일 변경 시 증분 빌드(Incremental build)를 올바르게 수행합니다.

### `rspfile` / `rspfile_content`
명령어의 길이가 너무 길어질 경우(주로 Windows), 인자들을 응답 파일(Response file, `.rsp`)에 쓰고 이를 통해 컴파일러에 전달하도록 설정합니다.

## 5. 예제: 간단한 C 컴파일러 도구 정의

```gn
tool("cc") {
  # 1. 의존성 파일 경로 패턴
  depfile = "{{output}}.d"

  # 2. 실제 실행될 명령어
  command = "gcc -MMD -MF $depfile {{defines}} {{include_dirs}} {{cflags}} {{cflags_c}} -c {{source}} -o {{output}}"

  # 3. 의존성 파일 형식
  depsformat = "gcc"

  # 4. 빌드 시 출력될 메시지
  description = "CC {{output}}"

  # 5. 생성될 객체 파일 경로 패턴
  outputs = [ "{{source_out_dir}}/{{target_output_name}}.{{source_name_part}}.o" ]
}
```
