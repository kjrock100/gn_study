# Chromium GN Declare Args 함수 가이드

`declare_args` 함수는 사용자가 빌드 시점에 외부에서 값을 변경할 수 있는 **빌드 인자(Build Arguments)**를 선언하고 기본값을 설정하는 데 사용됩니다. 이를 통해 개발자는 소스 코드를 수정하지 않고도 빌드 구성을 유연하게 제어할 수 있습니다.

## 1. 기본 구조 (Basic Structure)

```gn
declare_args() {
  enable_telemetry = true
  use_custom_allocator = false
  debug_level = 0
}
```

## 2. 작동 방식 (How it works)

1.  **기본값 설정**: 블록(`{ ... }`) 내부의 코드가 실행되며, 여기서 정의된 변수들은 해당 인자의 기본값이 됩니다.
2.  **오버라이드 확인**: GN은 사용자가 `gn args` 명령어나 `--args` 플래그를 통해 설정한 값이 있는지 확인합니다.
3.  **값 덮어쓰기**: 사용자가 설정한 값이 있다면, 기본값을 무시하고 사용자 설정값으로 변수를 덮어씁니다.
4.  **스코프 등록**: 최종 결정된 값이 현재 스코프의 변수로 등록됩니다.

## 3. 사용 예시 (Usage Examples)

### 3.1. 기본 사용법

```gn
declare_args() {
  # 디버그 모드 여부 (기본값: false)
  is_debug = false
  
  # CPU 아키텍처 (기본값: "x64")
  target_cpu = "x64"
}

if (is_debug) {
  defines = [ "DEBUG_MODE" ]
}
```

### 3.2. 조건부 기본값 설정

다른 변수의 값(OS, CPU 등)에 따라 기본값을 다르게 설정할 수 있습니다.

```gn
declare_args() {
  # Android일 때만 Java 지원 활성화
  if (target_os == "android") {
    enable_java = true
  } else {
    enable_java = false
  }
}
```

### 3.3. 상호 의존적인 인자

`declare_args` 블록은 여러 번 사용할 수 있습니다. 이를 통해 앞서 선언된 인자의 값을 바탕으로 다음 인자의 기본값을 결정할 수 있습니다.

```gn
declare_args() {
  enable_foo = true
}

declare_args() {
  # enable_foo가 true일 때만 enable_bar의 기본값을 true로 설정
  # (사용자는 여전히 gn args에서 enable_bar를 false로 강제할 수 있음)
  enable_bar = enable_foo
}
```

## 4. 스코프와 가시성 (Scope & Visibility)

*   **파일 스코프**: `declare_args`로 선언된 변수는 해당 파일 내에서 일반 변수처럼 사용할 수 있습니다.
*   **Import**: `.gni` 파일에서 선언된 인자는 해당 파일을 `import` 하는 모든 `BUILD.gn` 파일에서 볼 수 있습니다.
*   **전역 설정**: 프로젝트 전반에 걸쳐 사용되는 인자는 보통 `//build/config/BUILDCONFIG.gn`이나 별도의 `.gni` 파일(예: `//build/config/features.gni`)에 모아서 관리합니다.

## 5. 주의사항

*   **값 변경 불가**: `declare_args`로 선언된 변수는 빌드 파일 내에서 일반적인 할당(`=`)으로 값을 변경하려고 하면 에러가 발생하거나 무시될 수 있습니다. 인자 값은 외부(`gn args`)에서만 제어하는 것이 원칙입니다.
*   **사용되지 않는 인자**: 사용자가 `gn args`로 값을 설정했지만, 빌드 파일 내에서 `declare_args`로 선언되지 않은 변수라면 GN은 "Build argument has no effect" 경고나 에러를 발생시킵니다.
