# Chromium GN Refs 명령어 가이드

`gn refs`는 특정 타겟(Target)이나 파일(File)을 참조하는 **역의존성(Reverse Dependencies)**을 찾아주는 명령어입니다. "이 타겟을 누가 사용하고 있지?" 또는 "이 파일을 수정하면 어떤 타겟들이 영향을 받지?"라는 질문에 답할 때 사용합니다.

## 1. 기본 사용법 (Basic Usage)

```bash
gn refs <out_dir> (<target_label> | <file_path>)
```

*   **`<out_dir>`**: 빌드 디렉토리 경로 (예: `out/Default`).
*   **`<target_label>`**: 역의존성을 찾을 대상 타겟.
*   **`<file_path>`**: 역의존성을 찾을 대상 소스 파일.

### 예시

```bash
# //base:base 타겟을 직접 의존하는 타겟들 조회
gn refs out/Default //base:base

# my_source.cc 파일을 소스로 사용하는 타겟 조회
gn refs out/Default //my_module/my_source.cc
```

## 2. 주요 옵션 (Options)

### `--all`
기본적으로 `gn refs`는 직접적인(Direct) 역의존성만 보여줍니다. 간접적으로 의존하는 모든 상위 타겟(Transitive reverse dependencies)을 보고 싶다면 `--all` 옵션을 사용합니다.

```bash
# //base:base를 직/간접적으로 사용하는 모든 타겟 조회
gn refs out/Default //base:base --all
```

### `--testonly`
테스트 타겟 포함 여부를 필터링합니다.
*   `--testonly=true`: (기본값) 테스트 타겟을 포함하여 보여줍니다.
*   `--testonly=false`: 프로덕션 코드 타겟만 보여줍니다.

```bash
# 테스트를 제외하고, 실제 제품 코드에서 누가 사용하는지 확인
gn refs out/Default //my_lib --testonly=false
```

### `--type`
특정 유형의 타겟만 필터링하여 조회합니다.
*   지원 값: `executable`, `shared_library`, `static_library`, `source_set` 등.

```bash
# //base를 사용하는 실행 파일(executable)만 찾기
gn refs out/Default //base --all --type=executable
```

## 3. 활용 사례 (Use Cases)

*   **영향도 분석**: 코어 라이브러리를 수정하기 전에, 이 변경이 얼마나 많은 타겟에 영향을 미칠지 파악할 때 (`--all` 사용).
*   **Dead Code 제거**: 특정 타겟을 아무도 사용하지 않는지 확인할 때 (출력 결과가 없으면 사용되지 않는 것).
*   **구조 리팩토링**: 특정 모듈을 분리하거나 이동할 때, 해당 모듈을 의존하는 타겟들을 식별하여 `deps`를 수정해야 할 곳을 찾을 때.
*   **파일 소유 타겟 확인**: 특정 소스 파일이 어떤 타겟에 속해 있는지 모를 때 파일 경로로 조회하여 찾을 수 있습니다.
