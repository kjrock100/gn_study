# Chromium GN Outputs 변수 가이드

GN에서 `outputs`는 독립적인 명령어가 아니라, `action`, `copy`, `action_foreach` 등의 타겟이나 `toolchain`을 정의할 때 **생성되는 파일들의 목록을 지정하는 필수 변수**입니다.

`gn help outputs`를 통해 내장 도움말을 확인할 수 있습니다.

## 1. 역할 (Role)

*   **빌드 그래프 연결**: GN은 `outputs`에 명시된 파일을 보고, 이 파일을 `sources`로 사용하는 다른 타겟과의 의존 관계를 자동으로 형성합니다.
*   **Ninja 규칙 생성**: 생성된 Ninja 파일에서 해당 타겟의 출력물(Output)로 기록되어, 빌드 시스템이 파일의 생성 여부와 타임스탬프를 추적할 수 있게 합니다.
*   **증분 빌드**: 출력 파일이 존재하지 않거나 입력 파일보다 오래된 경우에만 다시 빌드(Rebuild)를 수행하는 기준이 됩니다.

## 2. 타겟별 사용법 (Usage by Target)

### 2.1. `action` 타겟
스크립트 실행 결과로 생성되는 **모든** 파일을 리스트로 나열해야 합니다. 스크립트가 파일을 생성하지만 `outputs`에 누락되면, 후속 타겟이 해당 파일을 찾지 못해 빌드 에러가 발생할 수 있습니다.

```gn
action("run_my_script") {
  script = "tools/gen.py"
  sources = [ "input.data" ]
  
  # 스크립트가 생성할 파일 경로 지정
  outputs = [ "$target_gen_dir/output.cc", "$target_gen_dir/output.h" ]
  
  args = [ ... ]
}
```

### 2.2. `copy` 타겟
복사된 파일이 위치할 대상 경로를 지정합니다. `sources` 리스트의 파일 개수와 정확히 일치해야 합니다.

```gn
copy("copy_config") {
  sources = [ "config.json" ]
  outputs = [ "$root_out_dir/config.json" ]
}
```

### 2.3. `action_foreach` 타겟
입력 소스 파일(`sources`) 하나당 출력 파일이 생성되므로, **치환 패턴(Substitution Patterns)**을 사용하여 출력 경로를 정의해야 합니다.

```gn
action_foreach("compile_shaders") {
  sources = [ "a.shader", "b.shader" ]
  
  # {{source_name_part}}는 확장자를 뺀 파일명 (예: "a")
  outputs = [ "$target_gen_dir/{{source_name_part}}.spv" ]
  
  args = [ ... ]
}
```

## 3. 치환 패턴 (Substitutions)

`action_foreach`나 `toolchain` 정의에서 `outputs`는 입력 파일에 따라 동적으로 결정되므로 다음 패턴들을 사용합니다.

*   `{{source}}`: 소스 파일의 전체 경로.
*   `{{source_name_part}}`: 디렉토리와 확장자를 제외한 파일 이름.
*   `{{source_file_part}}`: 파일 이름 (확장자 포함).
*   `{{source_dir}}`: 소스 파일이 위치한 디렉토리.
*   `{{source_out_dir}}`: 소스 파일 디렉토리에 대응하는 출력 디렉토리.

## 4. 출력 확인 방법 (`gn desc`)

특정 타겟이 어떤 파일들을 `outputs`로 설정하고 있는지 확인하려면 `gn desc` 명령어를 사용합니다.

```bash
# //my_module:my_target의 outputs 목록 조회
gn desc out/Default //my_module:my_target outputs
```
