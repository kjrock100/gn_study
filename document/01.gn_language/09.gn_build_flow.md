# Chromium GN 전체 빌드 흐름 (Overall Build Flow)

GN(Generate Ninja)이 빌드 파일을 읽고 최종적으로 Ninja 빌드 파일을 생성하기까지의 전체적인 흐름을 설명합니다.

## 1. 초기화 및 설정 (Initialization & Setup)

사용자가 터미널에서 `gn gen out/Default` 명령을 실행하면 다음 과정이 시작됩니다.

### 1.1. 소스 루트 및 `.gn` 파일 탐색
GN은 현재 디렉토리에서 상위로 올라가며 `.gn` 파일을 찾습니다. 이 파일이 있는 위치가 **소스 루트(Source Root, `//`)**가 됩니다.

### 1.2. `BUILDCONFIG.gn` 로드
`.gn` 파일에 정의된 `buildconfig` 변수가 가리키는 파일(주로 `//build/config/BUILDCONFIG.gn`)을 로드하고 실행합니다.
*   **전역 설정**: OS, CPU 아키텍처(`target_os`, `target_cpu`) 등 전역 변수가 설정됩니다.
*   **툴체인 정의**: `set_default_toolchain()`을 통해 기본 툴체인이 설정됩니다.

## 2. 타겟 파싱 및 그래프 구성 (Target Parsing & Graph Construction)

GN은 필요한 `BUILD.gn` 파일들만 읽어 메모리에 빌드 그래프(Build Graph)를 구성합니다.

### 2.1. 루트 타겟 로드
별도의 타겟을 지정하지 않으면, 소스 루트의 `//BUILD.gn` 파일에 있는 `default` 그룹(group) 타겟을 찾습니다.

### 2.2. 의존성 추적 (Dependency Walking)
시작 타겟의 `deps`, `public_deps`, `data_deps` 목록을 확인합니다.
*   참조된 타겟의 라벨(`//base:base`)을 확인하고, 해당 타겟이 정의된 `BUILD.gn` 파일을 로드합니다.
*   이 과정은 재귀적으로 반복되며, 빌드에 필요한 모든 파일이 로드될 때까지 계속됩니다.
*   **참고**: 의존성 트리에 포함되지 않은 `BUILD.gn` 파일은 로드되지 않으며 무시됩니다.

## 3. 설정 전파 및 해결 (Config Propagation & Resolution)

모든 타겟이 로드된 후, GN은 타겟 간의 관계를 분석하여 컴파일 설정을 확정합니다.

### 3.1. Config 적용
각 타겟에 정의된 `configs` 리스트가 적용됩니다.

### 3.2. 의존성 설정 전파
*   **`public_configs`**: 타겟의 헤더 파일 경로(`include_dirs`)나 정의(`defines`)가, 이 타겟을 의존하는 다른 타겟들에게 전파됩니다.
*   **`all_dependent_configs`**: (구식, 사용 지양) 이 타겟을 의존하는 모든 상위 타겟에게 전파됩니다.

## 4. Ninja 파일 생성 (Ninja File Generation)

완성된 빌드 그래프를 바탕으로, 실제 빌드를 수행할 Ninja 파일들을 생성합니다.

### 4.1. `build.ninja`
빌드 디렉토리(`out/Default`)의 루트에 생성됩니다. 전체 빌드를 시작하는 진입점 역할을 합니다.

### 4.2. 툴체인별 Ninja 파일
`toolchain.ninja` 등의 파일이 생성되며, 각 타겟을 컴파일하고 링크하는 구체적인 명령어(Command lines)가 기록됩니다.
*   이 단계에서 GN의 변수(`sources`, `cflags` 등)가 컴파일러 명령어 문자열로 변환됩니다.

## 5. 빌드 실행 (Build Execution)

GN의 역할은 여기까지입니다. 이후 사용자가 `ninja -C out/Default`를 실행하면, Ninja가 생성된 `.ninja` 파일들을 읽어 실제 컴파일과 링킹을 병렬로 수행합니다.
