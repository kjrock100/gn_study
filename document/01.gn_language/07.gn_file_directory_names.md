# Chromium GN 파일 및 디렉토리 명명 규칙 (File and Directory Names)

GN(Generate Ninja)은 파일 경로와 디렉토리 구조를 다룰 때 일관된 규칙을 사용합니다. 특히 크로스 플랫폼 빌드를 지원하기 위해 경로 구분자와 참조 방식에 대한 이해가 중요합니다.

## 1. 파일 명명 규칙 (File Naming)

### `BUILD.gn`
*   GN 빌드 시스템의 핵심 파일입니다.
*   각 디렉토리마다 하나씩 존재할 수 있으며, 해당 디렉토리의 타겟(Target)들을 정의합니다.
*   `gn gen` 명령 실행 시 루트 디렉토리부터 시작하여 의존성을 따라 로드됩니다.

### `.gni` (GN Import)
*   공통 변수, 템플릿, 설정 등을 정의하여 여러 `BUILD.gn` 파일에서 공유할 때 사용합니다.
*   `import("//build/config/compiler.gni")`와 같이 사용합니다.
*   일반적으로 변수나 템플릿 정의만 포함하며, 타겟 정의(`executable` 등)는 포함하지 않는 것이 관례입니다.

## 2. 경로 표현 방식 (Path Representation)

GN은 운영체제와 상관없이 항상 **슬래시(`/`)**를 경로 구분자로 사용합니다.

### 소스 루트 경로 (`//`)
*   소스 트리의 최상위 디렉토리(Top-level directory)를 의미합니다. `.gn` 파일이 위치한 곳입니다.
*   가장 권장되는 경로 참조 방식입니다.
*   예: `//base/logging.h`, `//chrome/browser`

### 상대 경로 (Relative Paths)
*   현재 `BUILD.gn` 파일이 있는 디렉토리를 기준으로 합니다.
*   예: `src/util.cc`, `../include/common.h`

### 시스템 절대 경로 (`/`)
*   시스템의 루트 디렉토리(C:/ 또는 /)를 의미합니다.
*   빌드 재현성(Reproducibility)을 해치므로, 시스템 헤더나 툴체인 설정 외에는 사용을 지양해야 합니다.

## 3. 주요 디렉토리 변수

GN은 빌드 산출물 위치를 관리하기 위해 내장 변수를 제공합니다.

*   `root_build_dir`: 빌드 결과물이 생성되는 최상위 디렉토리입니다. (예: `out/Default`)
*   `root_gen_dir`: 생성된 코드(Generated code)가 저장되는 루트 디렉토리입니다.
*   `target_gen_dir`: 현재 타겟을 위한 생성 파일 디렉토리입니다. 타겟의 경로 구조를 따라갑니다.

```gn
# 예: //my_module/BUILD.gn 내부
# target_gen_dir은 "out/Default/gen/my_module"이 됨
action("generate_header") {
  outputs = [ "$target_gen_dir/my_header.h" ]
  # ...
}
```

## 4. 타겟 라벨 (Target Labels)

GN에서 타겟을 참조하는 고유한 식별자입니다.

*   **형식**: `"//<path/to/dir>:<target_name>"`
*   **축약형**: 타겟 이름이 디렉토리 이름과 같다면 생략 가능합니다.
    *   `//base:base` -> `//base`
*   **현재 파일 내 참조**: 경로를 생략하고 콜론(`:`)으로 시작합니다.
    *   `:my_helper` (현재 `BUILD.gn` 내의 `my_helper` 타겟)

## 5. 경로 조작 함수

*   `rebase_path(input, new_base, current_base)`: 경로의 기준을 변경합니다. 주로 스크립트에 경로를 전달할 때, 빌드 디렉토리 기준 상대 경로로 변환하기 위해 사용합니다.
    ```gn
    # 소스 경로를 빌드 디렉토리 상대 경로로 변환
    args = [ rebase_path("data.txt", root_build_dir) ]
    ```
*   `get_path_info(input, what)`: 파일 경로에서 특정 부분(디렉토리, 이름, 확장자 등)을 추출합니다.
    ```gn
    name = get_path_info("src/foo.cc", "name") # "foo"
    dir = get_path_info("src/foo.cc", "dir")   # "src"
    ```
