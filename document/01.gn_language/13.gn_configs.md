# Chromium GN 설정 (Configs) 가이드

GN(Generate Ninja)에서 **설정(Config)**은 컴파일러 플래그, 전처리기 정의(Defines), 헤더 포함 경로(Include dirs) 등을 명명된 객체로 묶어 관리하는 기능입니다. 이를 통해 여러 타겟에서 공통된 빌드 설정을 재사용하고, 빌드 로직을 모듈화할 수 있습니다.

## 1. 설정 정의 (Defining Configs)

`config` 함수를 사용하여 설정을 정의합니다. 주로 `.gni` 파일이나 `BUILD.gn` 파일 상단에 위치합니다.

```gn
config("my_lib_config") {
  include_dirs = [ "include" ]
  defines = [ "ENABLE_MY_LIB" ]
  cflags = [ "-Wall", "-Wextra" ]
}
```

### 주요 변수
Config 내부에서 사용할 수 있는 주요 변수들입니다.
*   `cflags`, `cflags_c`, `cflags_cc`: C/C++ 컴파일러 플래그.
*   `defines`: 전처리기 매크로 정의 (`-D` 옵션).
*   `include_dirs`: 헤더 파일 검색 경로 (`-I` 옵션).
*   `ldflags`: 링커 플래그.
*   `libs`: 링크할 시스템 라이브러리.

## 2. 설정 적용 (Applying Configs)

타겟을 정의할 때 `configs` 리스트 변수를 사용하여 설정을 적용합니다.

### 기본 동작
대부분의 타겟(`executable`, `source_set` 등)은 생성 시 기본 설정(`set_defaults`로 지정된 값)을 가지고 있습니다.

```gn
executable("my_app") {
  # 기본 설정에 사용자 정의 설정 추가
  configs += [ ":my_lib_config" ]
  
  sources = [ "main.cc" ]
}
```

### 설정 제거
기본 설정 중 특정 플래그가 충돌하거나 불필요한 경우 제거할 수 있습니다.

```gn
source_set("legacy_code") {
  # 엄격한 경고 처리 설정을 제거
  configs -= [ "//build/config/compiler:chromium_code" ]
  configs += [ "//build/config/compiler:no_chromium_code" ]
}
```

## 3. 공개 설정 (Public Configs)

`public_configs`는 현재 타겟을 의존(`deps`)하는 **다른 타겟**들에게 설정을 전파할 때 사용합니다. 주로 라이브러리의 헤더 파일 경로를 사용하는 쪽에 알려줄 때 필수적입니다.

```gn
# 라이브러리 정의
static_library("mylib") {
  sources = [ "mylib.cc" ]
  
  # 내부 컴파일 시에는 "include" 디렉토리가 필요함
  # 그리고 이 라이브러리를 사용하는 쪽에서도 "include" 디렉토리를 알아야 함
  public_configs = [ ":mylib_public_config" ]
}

config("mylib_public_config") {
  include_dirs = [ "include" ]
}

# 실행 파일 정의
executable("app") {
  # mylib을 의존하므로, mylib_public_config가 자동으로 적용됨
  deps = [ ":mylib" ]
  
  sources = [ "main.cc" ] # main.cc에서 mylib.h를 include 가능
}
```

*   **`public_configs`**: 이 타겟과 이 타겟을 의존하는 타겟 모두에게 적용됩니다.
*   **`all_dependent_configs`**: (사용 지양) 이 타겟을 의존하는 모든 타겟에게 적용됩니다. `public_configs` 사용을 권장합니다.

## 4. 설정의 우선순위

`configs` 리스트의 순서는 중요합니다. 나중에 오는 설정이 이전 설정의 플래그를 덮어쓰거나(컴파일러 동작에 따라 다름), 순서에 의존적인 플래그(include path 검색 순서 등)에 영향을 줄 수 있습니다.

```gn
configs = [
  ":config_a", # 먼저 적용
  ":config_b", # 나중에 적용
]
```
