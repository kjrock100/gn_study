# Chromium GN 타겟 기본값 (Target Defaults) 가이드

GN(Generate Ninja)은 `set_defaults` 함수를 통해 특정 타겟 유형(`executable`, `shared_library` 등)에 대한 기본 변수 값을 설정할 수 있는 기능을 제공합니다. 이는 주로 빌드 구성 파일(`BUILDCONFIG.gn`)에서 모든 타겟에 공통적인 컴파일러 플래그나 설정을 적용할 때 사용됩니다.

## 1. `set_defaults` 함수

`set_defaults`는 특정 타겟 타입이 인스턴스화될 때, 해당 타겟의 스코프 내에 미리 변수들을 설정해두는 역할을 합니다.

### 문법 (Syntax)

```gn
set_defaults(target_type_string) {
  variable_name = value
  # ...
}
```

*   **`target_type_string`**: 기본값을 설정할 타겟 유형의 이름입니다 (예: `"executable"`, `"static_library"`, `"source_set"`).
*   **블록(`{}`) 내부**: 해당 타겟이 생성될 때 기본적으로 할당될 변수들을 정의합니다.

## 2. 작동 방식 (How it works)

GN이 `executable("my_app") { ... }`과 같은 타겟 정의를 만나면 다음과 같은 순서로 처리합니다.

1.  타겟을 위한 새로운 스코프를 생성합니다.
2.  `set_defaults("executable")`로 정의된 변수들을 이 스코프에 복사합니다.
3.  타겟 정의 블록(`{ ... }`) 내부의 코드를 실행합니다. 이때 사용자가 정의한 값이 기본값을 덮어쓰거나 수정(`+=`)할 수 있습니다.

## 3. 사용 예시 (Usage Example)

주로 `//build/config/BUILDCONFIG.gn` 파일에서 컴파일러 설정(`configs`)을 전역적으로 적용하기 위해 사용됩니다.

```gn
# BUILDCONFIG.gn

# 모든 타겟에 적용할 기본 설정 리스트 구성
_default_configs = [
  "//build/config:compiler_defaults",
  "//build/config:no_exceptions",
]

if (is_debug) {
  _default_configs += [ "//build/config:debug" ]
}

# executable 타겟에 대한 기본값 설정
set_defaults("executable") {
  configs = _default_configs
}

# static_library 타겟에 대한 기본값 설정
set_defaults("static_library") {
  configs = _default_configs
}
```

## 4. 기본값 수정 및 오버라이드

사용자가 `BUILD.gn`에서 타겟을 정의할 때, `set_defaults`로 설정된 값을 수정할 수 있습니다.

```gn
executable("my_tool") {
  # set_defaults에 의해 configs에는 이미 기본 설정들이 들어있음
  
  # 기본 설정에 추가
  configs += [ "//my_module:custom_config" ]
  
  # 기본 설정 중 일부 제거 (필요한 경우)
  configs -= [ "//build/config:no_exceptions" ]
}
```

## 5. 주의사항

*   **적용 범위**: `set_defaults`는 해당 함수가 호출된 이후에 정의되는 타겟들에만 영향을 미칩니다. 따라서 보통 빌드 초기화 단계인 `BUILDCONFIG.gn`에서 설정합니다.
*   **사용자 정의 템플릿**: `template`으로 정의한 사용자 정의 타겟 이름에 대해서는 `set_defaults`를 직접 사용할 수 없습니다. 내장 타겟 타입(`executable`, `shared_library`, `static_library`, `source_set`, `component`, `group`)에만 적용됩니다.
