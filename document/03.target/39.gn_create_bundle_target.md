# Chromium GN Create Bundle 타겟 가이드

`create_bundle` 타겟은 macOS 및 iOS에서 사용되는 애플리케이션 번들(Application Bundle, `.app`, `.framework` 등) 구조를 생성하는 데 사용됩니다.

## 1. 역할 (Role)

이 타겟은 직접 소스 코드를 컴파일하지 않습니다. 대신, `deps`에 지정된 `bundle_data` 타겟들이 정의한 파일들을 모아서, 지정된 디렉토리 구조(번들 구조)로 배치하는 역할을 합니다.

## 2. 기본 구조 (Basic Structure)

```gn
create_bundle("my_app") {
  product_type = "com.apple.product-type.application"
  
  bundle_root_dir = "$root_out_dir/my_app.app"
  bundle_contents_dir = "$bundle_root_dir/Contents"
  bundle_resources_dir = "$bundle_contents_dir/Resources"
  bundle_executable_dir = "$bundle_contents_dir/MacOS"
  
  deps = [
    ":my_app_binary_data",
    ":my_app_resources",
  ]
}
```

## 3. 주요 변수 (Key Variables)

### `product_type` (필수)
생성할 번들의 유형을 지정하는 문자열입니다. Xcode 프로젝트 생성 시 사용되며, 빌드 시스템이 적절한 후처리를 하도록 돕습니다.
*   `"com.apple.product-type.application"`: 앱 (`.app`)
*   `"com.apple.product-type.framework"`: 프레임워크 (`.framework`)
*   `"com.apple.product-type.app-extension"`: 앱 확장

### 디렉토리 변수 (필수)
번들 내부의 표준 디렉토리 구조를 정의합니다. `bundle_data` 타겟에서 `{{bundle_resources_dir}}` 같은 패턴을 사용할 때 이 변수들이 참조됩니다.
*   `bundle_root_dir`: 번들의 최상위 디렉토리.
*   `bundle_contents_dir`: `Contents` 디렉토리 (macOS).
*   `bundle_resources_dir`: 리소스가 위치할 디렉토리.
*   `bundle_executable_dir`: 실행 파일이 위치할 디렉토리.

### `deps`
번들에 포함될 내용을 정의하는 타겟들입니다. `create_bundle`은 `deps`를 순회하며 `bundle_data` 타겟을 찾아 그 규칙대로 파일을 복사합니다.

## 4. 전체 예제 (Full Example)

macOS 애플리케이션 번들을 만드는 과정입니다. 실행 파일도 `bundle_data`를 통해 번들 내부로 복사해야 합니다.

```gn
# 1. 실행 파일 빌드
executable("my_app_bin") {
  sources = [ "main.cc" ]
  output_name = "my_app"
}

# 2. 실행 파일을 번들 데이터로 정의
bundle_data("my_app_bin_data") {
  sources = [ "$root_out_dir/my_app" ]
  outputs = [ "{{bundle_executable_dir}}/my_app" ]
  public_deps = [ ":my_app_bin" ] # 실행 파일이 먼저 빌드되어야 함
}

# 3. 리소스 파일 정의
bundle_data("my_app_resources") {
  sources = [ "Info.plist", "Icon.icns" ]
  outputs = [ "{{bundle_resources_dir}}/{{source_file_part}}" ]
}

# 4. 번들 생성
create_bundle("my_app") {
  product_type = "com.apple.product-type.application"
  bundle_root_dir = "$root_out_dir/my_app.app"
  bundle_contents_dir = "$bundle_root_dir/Contents"
  bundle_resources_dir = "$bundle_contents_dir/Resources"
  bundle_executable_dir = "$bundle_contents_dir/MacOS"
  
  deps = [ ":my_app_bin_data", ":my_app_resources" ]
}
```

## 5. 코드 서명 (Code Signing)

`create_bundle` 타겟은 코드 서명 스크립트를 실행할 수 있는 변수들을 제공합니다.

*   `code_signing_script`: 서명을 수행할 스크립트 경로.
*   `code_signing_sources`: 스크립트의 입력 파일 (프로비저닝 프로파일 등).
*   `code_signing_outputs`: 서명 결과 파일.
*   `code_signing_args`: 스크립트 인자.
