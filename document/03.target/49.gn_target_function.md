# Chromium GN Target 함수 가이드

`target` 함수는 타겟의 유형(type)을 문자열 변수로 지정하여 정의할 수 있게 해주는 일반화된 함수입니다. `executable`, `source_set` 같은 구체적인 함수 대신 사용하여, 타겟 유형을 동적으로 결정해야 할 때 유용합니다.

## 1. 기본 구조 (Basic Structure)

```gn
target("source_set", "my_target") {
  sources = [ "a.cc" ]
}
```

위 코드는 아래와 동일합니다:

```gn
source_set("my_target") {
  sources = [ "a.cc" ]
}
```

## 2. 문법 (Syntax)

```gn
target(target_type_string, target_name) {
  # 타겟 설정 변수들 (sources, deps, configs 등)
  ...
}
```

*   **`target_type_string`**: 타겟 유형을 나타내는 문자열입니다. (예: `"executable"`, `"shared_library"`, `"static_library"`, `"source_set"`, `"group"`, `"action"` 등)
    *   **주의**: 내장 타겟 유형만 가능하며, 사용자 정의 템플릿 이름은 사용할 수 없습니다.
*   **`target_name`**: 타겟의 이름입니다.

## 3. 사용 예시 (Usage Examples)

### 3.1. 동적 타겟 유형 결정

조건에 따라 타겟 유형이 바뀌어야 하는 경우 유용합니다.

```gn
if (is_component_build) {
  my_type = "shared_library"
} else {
  my_type = "static_library"
}

target(my_type, "my_lib") {
  sources = [ "lib.cc" ]
  defines = [ "MY_LIB_IMPLEMENTATION" ]
}
```

### 3.2. 커스텀 템플릿에서의 활용

템플릿 내부에서 입력받은 타입으로 타겟을 생성할 때 자주 사용됩니다. 이를 통해 여러 유형의 타겟을 감싸는 래퍼(Wrapper)를 만들 수 있습니다.

```gn
template("my_wrapper") {
  # invoker.target_type이 존재하면 그것을 사용하고, 아니면 source_set을 기본값으로 사용
  if (defined(invoker.target_type)) {
    _type = invoker.target_type
  } else {
    _type = "source_set"
  }

  target(_type, target_name) {
    forward_variables_from(invoker, "*", [ "target_type" ])
    
    # 공통 설정 추가
    if (!defined(deps)) { deps = [] }
    deps += [ "//common:base" ]
  }
}

# 사용 예시
my_wrapper("lib_a") {
  sources = [ "a.cc" ]
}

my_wrapper("bin_b") {
  target_type = "executable"
  sources = [ "main.cc" ]
}
```

## 4. 주의사항

*   **가독성**: `target` 함수는 `template` 정의 내부가 아닌 일반 `BUILD.gn` 파일에서도 사용할 수 있지만, 가독성을 위해 명시적인 함수(`executable`, `static_library` 등)를 사용하는 것이 권장됩니다. 동적인 처리가 꼭 필요한 경우에만 사용하세요.
*   **템플릿 불가**: `target` 함수의 첫 번째 인자로 사용자 정의 템플릿의 이름을 사용할 수 없습니다. 오직 GN 내장 타겟 유형만 가능합니다.
