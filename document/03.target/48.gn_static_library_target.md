# Chromium GN Static Library 타겟 가이드

`static_library` 타겟은 C/C++ 소스 코드를 컴파일하여 **정적 라이브러리(Static Library)** 파일(`.a` 또는 `.lib`)을 생성하는 데 사용됩니다.

## 1. 기본 구조 (Basic Structure)

```gn
static_library("my_lib") {
  sources = [
    "lib.cc",
    "lib.h",
  ]

  deps = [ "//base" ]
  defines = [ "MY_LIB_IMPLEMENTATION" ]
}
```

## 2. 주요 변수 (Key Variables)

### `sources`
컴파일할 소스 파일 목록입니다.

### `deps`
이 라이브러리가 의존하는 다른 타겟 목록입니다.

### `output_name`
생성될 라이브러리 파일의 이름입니다. (기본값: 타겟 이름)
*   Linux/Mac에서는 `lib` 접두사가 자동으로 붙어 `libmy_lib.a`가 생성됩니다.
*   Windows에서는 `my_lib.lib`가 생성됩니다.

### `complete_static_lib`
`true`로 설정하면, 이 라이브러리의 모든 의존성(`deps`)을 포함하여 하나의 거대한 정적 라이브러리를 생성합니다.
*   기본적으로 `static_library`는 자신의 소스 코드만 컴파일하여 아카이빙합니다.
*   이 옵션은 배포용 라이브러리를 만들 때 유용하지만, 모든 툴체인에서 지원되는 것은 아닙니다.

## 3. `static_library` vs `source_set`

Chromium 프로젝트에서는 `static_library`보다 `source_set`을 더 선호하는 경향이 있습니다.

| 특징 | `static_library` | `source_set` |
| :--- | :--- | :--- |
| **산출물** | 아카이브 파일 (`.a`, `.lib`) | 없음 (객체 파일 집합) |
| **링킹 오버헤드** | 아카이빙 단계가 있어 약간 느림 | 아카이빙 없이 링커에 직접 전달되어 빠름 |
| **심볼 처리** | 링커가 참조되지 않은 심볼을 제거(Strip)하기 쉬움 | 모든 객체 파일이 링커에 전달됨 |
| **용도** | 외부 배포, 캐싱, 심볼 중복 방지 | 프로젝트 내부 모듈, 빠른 빌드 |

## 4. 사용 예시 (Usage Examples)

### 일반적인 정적 라이브러리

```gn
static_library("xml_parser") {
  sources = [ "xml_parser.cc" ]
  public_deps = [ "//third_party/libxml" ]
}
```

### 모든 의존성을 포함한 배포용 라이브러리

```gn
static_library("sdk_lib") {
  complete_static_lib = true
  sources = [ "sdk_api.cc" ]
  deps = [ ":internal_implementation" ]
}
```

## 5. 주의사항

*   **중복 심볼**: 여러 `static_library`가 동일한 `source_set`이나 `static_library`를 의존하고, 이들이 최종 실행 파일에 링크될 때 심볼 중복 오류가 발생할 수 있습니다. `source_set`을 사용하면 이러한 문제를 링커가 더 유연하게 처리하는 경우가 많습니다.
*   **전역 생성자**: 정적 라이브러리에 포함된 전역 객체의 생성자는 해당 객체의 심볼이 참조되지 않으면 실행되지 않을 수 있습니다. 이를 강제하려면 링커 플래그(예: `--whole-archive`)가 필요할 수 있습니다.
