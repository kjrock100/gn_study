# Chromium GN 내장 변수 (Built-in Predefined Variables) 가이드

GN은 빌드 구성을 위해 다양한 내장 변수를 제공합니다. 이 변수들은 현재 빌드 환경(OS, CPU), 툴체인, 타겟 정보 등을 담고 있으며, 조건부 빌드 로직을 작성하는 데 필수적입니다.

## 1. 빌드 인자 관련 변수 (Build Argument Variables)

`declare_args`를 통해 선언되며, 사용자가 `args.gn`에서 값을 변경할 수 있습니다. 가장 대표적인 변수들은 다음과 같습니다.

*   `is_debug`: 디버그 빌드 여부 (`true` 또는 `false`).
*   `is_component_build`: 컴포넌트 빌드(공유 라이브러리) 여부.
*   `is_asan`, `is_msan`, `is_tsan`: 각종 Sanitizer 사용 여부.
*   `symbol_level`: 심볼 정보 수준 (0, 1, 2).
*   `target_os`: 최종 산출물이 실행될 운영체제 (예: `"linux"`, `"win"`, `"android"`).
*   `target_cpu`: 최종 산출물의 CPU 아키텍처 (예: `"x64"`, `"arm64"`).

## 2. 현재 툴체인 정보 (Current Toolchain Information)

이 변수들은 현재 실행 중인 툴체인의 컨텍스트를 나타냅니다.

*   `current_cpu`, `current_os`: 현재 툴체인이 대상으로 하는 CPU와 OS. 크로스 컴파일 시 `target_cpu`/`target_os`와 다를 수 있습니다.
*   `host_cpu`, `host_os`: GN이 실행되고 있는 호스트 머신의 CPU와 OS.
*   `current_toolchain`: 현재 툴체인의 라벨 (예: `//build/toolchain/linux:clang_x64`).
*   `default_toolchain`: 기본 툴체인의 라벨.

## 3. 디렉토리 경로 변수 (Directory Path Variables)

경로를 다룰 때 자주 사용되는 변수들입니다.

*   `//`: 소스 트리의 루트 디렉토리.
*   `root_build_dir`: 빌드 출력 디렉토리의 루트 (예: `out/Default`).
*   `root_out_dir`: `root_build_dir`와 동일합니다.
*   `root_gen_dir`: 생성된 파일이 위치하는 루트 디렉토리 (예: `out/Default/gen`).
*   `target_gen_dir`: 현재 타겟의 위치에 대응하는 생성 파일 디렉토리.
*   `target_out_dir`: 현재 타겟의 객체 파일 등이 위치하는 출력 디렉토리.

## 4. 타겟 내부 변수 (Variables inside a Target)

`executable`, `source_set` 등 타겟 정의 블록 내에서 사용되는 변수들입니다.

*   `target_name`: 현재 타겟의 이름 (문자열).
*   `invoker`: (템플릿 내부에서) 템플릿을 호출한 스코프의 변수들을 담고 있는 객체.

### 타겟 속성 변수

타겟의 동작을 정의하기 위해 값을 할당하는 변수들입니다.

*   `sources`: 소스 파일 목록.
*   `deps`, `public_deps`, `data_deps`: 의존성 목록.
*   `configs`, `public_configs`: 적용할 설정 목록.
*   `cflags`, `cflags_cc`, `defines`, `include_dirs`, `ldflags`: 컴파일러 및 링커 플래그.
*   `outputs`: `action` 등에서 생성되는 출력 파일 목록.
*   `visibility`: 타겟의 가시성.

## 5. 예제: 변수 사용

```gn
print("Building for $target_os on $target_cpu")

if (current_os == host_os) {
  print("Not cross-compiling.")
}

executable("my_app") {
  sources = [ "main.cc" ]

  # is_debug 값에 따라 다른 라이브러리 의존
  if (is_debug) {
    deps = [ ":debug_utils" ]
  } else {
    deps = [ ":release_utils" ]
  }

  # 현재 타겟의 생성 디렉토리에 파일 생성
  write_file("$target_gen_dir/info.txt", "Built $target_name")
}
```


Built-in predefined variables (type "gn help <variable>" for more help):
  current_cpu: [string] The processor architecture of the current toolchain.
  current_os: [string] The operating system of the current toolchain.
  current_toolchain: [string] Label of the current toolchain.
  default_toolchain: [string] Label of the default toolchain.
  gn_version: [number] The version of gn.
  host_cpu: [string] The processor architecture that GN is running on.
  host_os: [string] The operating system that GN is running on.
  invoker: [string] The invoking scope inside a template.
  python_path: [string] Absolute path of Python.
  root_build_dir: [string] Directory where build commands are run.
  root_gen_dir: [string] Directory for the toolchain's generated files.
  root_out_dir: [string] Root directory for toolchain output files.
  target_cpu: [string] The desired cpu architecture for the build.
  target_gen_dir: [string] Directory for a target's generated files.
  target_name: [string] The name of the current target.
  target_os: [string] The desired operating system for the build.
  target_out_dir: [string] Directory for target output files.

Variables you set in targets (type "gn help <variable>" for more help):
  aliased_deps: [scope] Set of crate-dependency pairs.
  all_dependent_configs: [label list] Configs to be forced on dependents.
  allow_circular_includes_from: [label list] Permit includes from deps.
  arflags: [string list] Arguments passed to static_library archiver.
  args: [string list] Arguments passed to an action.
  asmflags: [string list] Flags passed to the assembler.
  assert_no_deps: [label pattern list] Ensure no deps on these targets.
  bridge_header: [string] Path to C/Objective-C compatibility header.
  bundle_contents_dir: Expansion of {{bundle_contents_dir}} in create_bundle.
  bundle_deps_filter: [label list] A list of labels that are filtered out.
  bundle_executable_dir: Expansion of {{bundle_executable_dir}} in create_bundle
  bundle_resources_dir: Expansion of {{bundle_resources_dir}} in create_bundle.
  bundle_root_dir: Expansion of {{bundle_root_dir}} in create_bundle.
  cflags: [string list] Flags passed to all C compiler variants.
  cflags_c: [string list] Flags passed to the C compiler.
  cflags_cc: [string list] Flags passed to the C++ compiler.
  cflags_objc: [string list] Flags passed to the Objective C compiler.
  cflags_objcc: [string list] Flags passed to the Objective C++ compiler.
  check_includes: [boolean] Controls whether a target's files are checked.
  code_signing_args: [string list] [deprecated] Args for the post-processing script.
  code_signing_outputs: [file list] [deprecated] Outputs of the post-processing step.
  code_signing_script: [file name] [deprecated] Script for the post-processing step.
  code_signing_sources: [file list] [deprecated] Sources for the post-processing step.
  complete_static_lib: [boolean] Links all deps into a static library.
  configs: [label list] Configs applying to this target or config.
  contents: Contents to write to file.
  crate_name: [string] The name for the compiled crate.
  crate_root: [string] The root source file for a binary or library.
  crate_type: [string] The type of linkage to use on a shared_library.
  data: [file list] Runtime data file dependencies.
  data_deps: [label list] Non-linked dependencies.
  data_keys: [string list] Keys from which to collect metadata.
  defines: [string list] C preprocessor defines.
  depfile: [string] File name for input dependencies for actions.
  deps: [label list] Private linked dependencies.
  externs: [scope] Set of Rust crate-dependency pairs.
  framework_dirs: [directory list] Additional framework search directories.
  frameworks: [name list] Name of frameworks that must be linked.
  friend: [label pattern list] Allow targets to include private headers.
  gen_deps: [label list] Declares targets that should generate when this one does.
  include_dirs: [directory list] Additional include directories.
  inputs: [file list] Additional compile-time dependencies.
  ldflags: [string list] Flags passed to the linker.
  lib_dirs: [directory list] Additional library directories.
  libs: [string list] Additional libraries to link.
  metadata: [scope] Metadata of this target.
  mnemonic: [string] Prefix displayed when ninja runs this action.
  module_name: [string] The name for the compiled module.
  output_conversion: Data format for generated_file targets.
  output_dir: [directory] Directory to put output file in.
  output_extension: [string] Value to use for the output's file extension.
  output_name: [string] Name for the output file other than the default.
  output_prefix_override: [boolean] Don't use prefix for output name.
  outputs: [file list] Output files for actions and copy targets.
  partial_info_plist: [filename] Path plist from asset catalog compiler.
  pool: [string] Label of the pool used by binary targets and actions.
  post_processing_args: [string list] Args for the post-processing script.
  post_processing_outputs: [file list] Outputs of the post-processing step.
  post_processing_script: [file name] Script for the post-processing step.
  post_processing_sources: [file list] Sources for the post-processing step.
  precompiled_header: [string] Header file to precompile.
  precompiled_header_type: [string] "gcc" or "msvc".
  precompiled_source: [file name] Source file to precompile.
  product_type: [string] Product type for the bundle.
  public: [file list] Declare public header files for a target.
  public_configs: [label list] Configs applied to dependents.
  public_deps: [label list] Declare public dependencies.
  rebase: [boolean] Rebase collected metadata as files.
  response_file_contents: [string list] Contents of .rsp file for actions.
  rustflags: [string list] Flags passed to the Rust compiler.
  script: [file name] Script file for actions.
  sources: [file list] Source files for a target.
  swiftflags: [string list] Flags passed to the swift compiler.
  testonly: [boolean] Declares a target must only be used for testing.
  transparent: [bool] True if the bundle is transparent.
  visibility: [label list] A list of labels that can depend on a target.
  walk_keys: [string list] Key(s) for managing the metadata collection walk.
  weak_frameworks: [name list] Name of frameworks that must be weak linked.
  write_runtime_deps: Writes the target's runtime_deps to the given path.
  xcasset_compiler_flags: [string list] Flags passed to xcassets compiler
  xcode_extra_attributes: [scope] Extra attributes for Xcode projects.
  xcode_test_application_name: [string] Name for Xcode test target.

Other help topics:
  all: Print all the help at once
  buildargs: How build arguments work.
  dotfile: Info about the toplevel .gn file.
  execution: Build graph and execution overview.
  grammar: Language and grammar for GN build files.
  input_conversion: Processing input from exec_script and read_file.
  file_pattern: Matching more than one file.
  label_pattern: Matching more than one label.
  labels: About labels.
  metadata_collection: About metadata and its collection.
  ninja_rules: How Ninja build rules are named.
  nogncheck: Annotating includes for checking.
  output_conversion: Specifies how to transform a value to output.
  runtime_deps: How runtime dependency computation works.
  source_expansion: Map sources to outputs for scripts.
  switches: Show available command-line switches.